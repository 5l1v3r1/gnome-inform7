<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>19.2. Memory limitations with indexed text</title></head>
<STYLE TYPE="text/css">
<!--
.oval, .oval TD
{
background-image:url('../doc_images/ovoid.png');
color:white;
}
.wiarrow, .wiarrow TD
{
background-image:url('../doc_images/wiarrow.png');
color:white;
}
.rbarrow, .rbarrow TD
{
background-image:url('../doc_images/rbarrow.png');
color:white;
}
-->
</STYLE>
<body bgcolor="#ffffff">
<!-- SEARCH TITLE "Memory limitations with indexed text" -->
<!-- SEARCH SECTION "19.2" -->
<!-- SEARCH SORT "019-002-000" -->
<font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><table CELLPADDING=0 CELLSPACING=0 width="100%" bgcolor="#000000"><tr><TD width=38px height=26px align="center" valign="center"><a href=doc328.html border=0><img border=0 src=../doc_images/Hookleft.png id="hookleft" style="height: 24px; width: 32px;" border=0></a></td><td halign="left" valign="center" CELLPADDING=0 CELLSPACING=0><a href=../chap19.html STYLE="text-decoration: none"><font color="#FFFFFF" size=2>Chapter 19: Advanced Text</font></a></td><TD width=56px height=26px align="right" valign="center"><a href=../index.html border=0><img border=0 src=../doc_images/Hookup.png id="hookup" style="height: 24px; width: 24px;" border=0></a><a href=doc330.html border=0><img border=0 src=../doc_images/Hookright.png id="hookright" style="height: 24px; width: 32px;" border=0></a></td></tr></table><table CELLPADDING=0 CELLSPACING=0 width="100%"><tr><TD height=8px halign="center" valign="center"></td></tr></table><table CELLPADDING=0 CELLSPACING=0 width="100%"><tr><TD width=38px halign="center" valign="center"></td><td halign="left" valign="center" CELLPADDING=0 CELLSPACING=0><font color="#000000" size="3"><b>19.2. Memory limitations with indexed text</b></font></td></tr></table>
<p>
<p>Because Inform helps us to pretend that dynamic text is as easy to handle as numbers, we can often forget all about the difference between text and indexed text (until we get to creating variables, properties and table columns, anyway). But it's best to be aware that this really is a pretence. The following warnings are rather like the tiny print about side-effects on medicine bottles: that is, we mostly ignore them, and if the drugs should kill us, well, at least we have the consolation of knowing we were warned.
<p>
<p>Inform creates &quot;story files&quot; for very small virtual computers (capable of running on phones, for instance) where memory is tight. If we create a number variable and keep on adding 1 to it, the value simply gets bigger. But if we make some text and keep on adding a letter &quot;x&quot; to it, the text takes up more and more space, growing into longer and longer runs of &quot;x&quot;s until there is no more space to hold it. There are basically three limitations on indexed text:
<p>
<p>(1) An amount of memory has to be set aside for indexed text (and other flexible-sized data), and Inform guesses the amount needed. The amount can be increased with a use option, like so:
<p>
<blockquote><font color="#000080">Use dynamic memory allocation of at least 16384.
</font></blockquote><p>
<p>
<p>Inform raises its estimate of the amount needed to ensure that this amount is always at least its own guess, and also at least any amount declared like this. (And then it rounds up to the nearest power of 2, as it happens.) The default value of &quot;dynamic memory allocation&quot; is 8192.
<p>
<p>Glulx story files have the advantage here that, if they find themselves running on version 3.1.0 or later of the Glulx machine, they can use Glulx's new memory allocation features to grow their own memories as necessary, so that there are no hard limits at all.
<p>
<p>(2) When text is changed into indexed text, there may a maximum length it cannot exceed. The maximum is normally 1000 characters, which ought to be plenty, but can be raised by sentences such as:
<p>
<blockquote><font color="#000080">Use maximum indexed text length of at least 2000.
</font></blockquote><p>
<p>
<p>What happens if this is broken, that is, if we try to use text overrunning this length? The Z-machine may simply crash, so if there is any chance that any single indexed text may grow unpredictably large, Glulx should always be used. On Glulx, overrunning text is truncated safely, except that under Glulx 3.1.0 or better the story file will try to use dynamic memory allocation to expand the limit as needed to avoid truncation. (Testing shows that text is slow to manipulate once it grows beyond about 20,000 characters in length, but this is not really surprising.)
<p>
<p>(3) Under the Z-machine, indexed text may only contain characters from the so-called &quot;ZSCII&quot; character set - standard numbers, letters, punctuation marks and the commonest West European accented letters. Anything more exotic is likely to be flattened into a question mark &quot;?&quot;. Under Glulx, any character can be used.
<p>
<p>All of this makes the Z-machine sound very inferior, for indexed text purposes. But note that Z can handle all of the examples in this chapter perfectly happily.
<p>
<p><hr><table CELLPADDING=0 CELLSPACING=0 width="100%"><tr><td width="33%" align="left"><a href=doc328.html border=0 STYLE="text-decoration: none"><font color="808080" size="2">Previous</font></a></td><td width="33%" align="center"><a href=../index.html border=0 STYLE="text-decoration: none"><font color="808080" size="2">Contents</font></a></td><td width="33%" align="right"><a href=doc330.html border=0 STYLE="text-decoration: none"><font color="808080" size="2">Next</font></a></td></tr></table></font></body></html>
