<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>18.17. Two rulebooks used internally</title></head>
<STYLE TYPE="text/css">
<!--
.oval, .oval TD
{
background-image:url('../doc_images/ovoid.png');
color:white;
}
.wiarrow, .wiarrow TD
{
background-image:url('../doc_images/wiarrow.png');
color:white;
}
.rbarrow, .rbarrow TD
{
background-image:url('../doc_images/rbarrow.png');
color:white;
}
-->
</STYLE>
<body bgcolor="#ffffff">
<!-- SEARCH TITLE "Timeless" -->
<!-- SEARCH SECTION "Ex 375" -->
<!-- SEARCH SORT "Ex 018-017-375" -->
<font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><table CELLPADDING=0 CELLSPACING=0 width="100%" bgcolor="#000000"><tr><TD width=38px height=26px align="center" valign="center"><a href=doc324.html border=0><img border=0 src=../doc_images/Hookleft.png id="hookleft" style="height: 24px; width: 32px;" border=0></a></td><td halign="left" valign="center" CELLPADDING=0 CELLSPACING=0><a href=../chap18.html STYLE="text-decoration: none"><font color="#FFFFFF" size=2>Chapter 18: Rulebooks</font></a></td><TD width=56px height=26px align="right" valign="center"><a href=../index.html border=0><img border=0 src=../doc_images/Hookup.png id="hookup" style="height: 24px; width: 24px;" border=0></a><a href=doc326.html border=0><img border=0 src=../doc_images/Hookright.png id="hookright" style="height: 24px; width: 32px;" border=0></a></td></tr></table><table CELLPADDING=0 CELLSPACING=0 width="100%"><tr><TD height=8px halign="center" valign="center"></td></tr></table><table CELLPADDING=0 CELLSPACING=0 width="100%"><tr><TD width=38px halign="center" valign="center"></td><td halign="left" valign="center" CELLPADDING=0 CELLSPACING=0><font color="#000000" size="3"><b>18.17. Two rulebooks used internally</b></font></td></tr></table>
<p>
<p>Rulebooks handle almost all of the important tasks which an Inform work of IF must carry out in order to keep play going. We have seen them used in clarifying the player's command, supplying missing ingredients, processing the action to see what should happen, responding, and so on: by this point in the documentation, it must look as if Inform uses rulebooks for everything.
<p>
<p>This is nearly true. There is not actually a super-rulebook controlling everything. (Such a super-rulebook would need to repeat itself and never finish, something a rulebook is not allowed to do.) Instead, what happens during play looks like so:
<p>
<blockquote><font color="#000080">1. Following the &quot;when play begins&quot; rulebook.
<br>2. Repeating:
<br>&nbsp;&nbsp;&nbsp;&nbsp;2(a). Reading and parsing a command into an action;
<br>&nbsp;&nbsp;&nbsp;&nbsp;2(b). Following the &quot;action processing&quot; rulebook;
<br>&nbsp;&nbsp;&nbsp;&nbsp;2(c). Following the &quot;turn sequence&quot; rulebook.
<br>until the game has finished.
<br>3. Following the &quot;when play ends&quot; rulebook.
</font></blockquote><p>
<p>
<p>The command parser occasionally calls on the services of activity rulebooks to help it, but otherwise gets on with its job in ways that we do not &quot;see&quot; as Inform 7 users. The rest of what happens involves rulebooks, and in particular two important beneath-the-surface rulebooks: action processing and the turn sequence.
<p>
<p>The <b>action processing rules</b> are used whenever an action must be tried, by whoever tries it. This usually happens in response to player commands, but not always: it might happen because of a &quot;try...&quot;, and it can certainly interrupt an existing action.
<p>
<p>The <b>turn sequence rules</b> are used at the end of each turn, and include housekeeping as well as timekeeping. They consult the &quot;every turn&quot; rulebook, and advance the time of day, among other useful tasks.
<p>
<p>In general, we should only modify the operation of these two crucial rulebooks as a last resort. Play can evidently fall to pieces if they cease to work normally.
<p>
<p><hr><p>
<a name="e331"><table CELLPADDING=0 CELLSPACING=0 width="100%"><tr><td halign="left" valign="top" CELLPADDING=0 CELLSPACING=0 width=38px><TABLE align="left" CELLPADDING=0 CELLSPACING=0><TR CLASS="oval"><TD width=38px height=30px align="left" valign="center"><a href=ex331.html#e331 STYLE="text-decoration: none"><div class="paragraph Body" style="line-height: 1px; margin-bottom: 0px; margin-top: 4px; padding-bottom: 0pt; padding-top: 4px; text-align: center; color: #202020; font-size: 14px; line-height: 1px;"><b>374</b></div></a></TD></TR></TABLE></td><td CELLPADDING=0 CELLSPACING=0 halign="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><a href=ex331.html#e331 STYLE="text-decoration: none"><img border="0" style="height: 15px; width: 13px;" alt="*" src='../doc_images/asterisk.png'><b><font color="#505050">&nbsp;Example&nbsp;</font> <font color="#000000"> Electrified</font></b></a><br>Adding a rule before the basic accessibility rule that will prevent the player from touching electrified objects under the wrong circumstances.<p></td><td halign="right" valign="top" CELLPADDING=0 CELLSPACING=0 width=38px><TABLE align="left" CELLPADDING=0 CELLSPACING=0><TR CLASS="rbarrow"><TD width=38px height=30px align="left" valign="center"><a  href=Rex331.html#e331 STYLE="text-decoration: none"><div class="paragraph Body" style="line-height: 1px; margin-bottom: 0px; margin-top: 4px; padding-bottom: 0pt; padding-top: 4px; text-align: center; color: #202020; font-size: 14px; line-height: 1px;"><i>RB</i></div></a></TD></TR></TABLE></td></tr></table>
<!-- EXAMPLE START -->
<a name="e62"><table CELLPADDING=0 CELLSPACING=0 width="100%"><tr><td halign="left" valign="top" CELLPADDING=0 CELLSPACING=0 width=38px><TABLE align="left" CELLPADDING=0 CELLSPACING=0><TR CLASS="oval"><TD width=38px height=30px align="left" valign="center"><a href=doc325.html#e62 STYLE="text-decoration: none"><div class="paragraph Body" style="line-height: 1px; margin-bottom: 0px; margin-top: 4px; padding-bottom: 0pt; padding-top: 4px; text-align: center; color: #202020; font-size: 14px; line-height: 1px;"><b>375</b></div></a></TD></TR></TABLE></td><td CELLPADDING=0 CELLSPACING=0 halign="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><a href=doc325.html#e62 STYLE="text-decoration: none"><img border="0" style="height: 15px; width: 13px;" alt="*" src='../doc_images/asterisk.png'><b><font color="#505050">&nbsp;<b>Example</b>&nbsp;</font> <font color="#000000"> Timeless</font></b></a><br>A set of actions which do not take any game time at all.<p></td><td halign="right" valign="top" CELLPADDING=0 CELLSPACING=0 width=38px><TABLE align="left" CELLPADDING=0 CELLSPACING=0><TR CLASS="rbarrow"><TD width=38px height=30px align="left" valign="center"><a  href=Rex62.html#e62 STYLE="text-decoration: none"><div class="paragraph Body" style="line-height: 1px; margin-bottom: 0px; margin-top: 4px; padding-bottom: 0pt; padding-top: 4px; text-align: center; color: #202020; font-size: 14px; line-height: 1px;"><i>RB</i></div></a></TD></TR></TABLE></td></tr></table>
<table border=0 bgcolor="#f0f0f0" width=100%><tr><td><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2>
<p>
<p>In a game with tight timing, it is sometimes friendliest to the player to let him LOOK and EXAMINE as much as necessary without being penalized.
<p>
<blockquote><font color="#000080"><script language="JavaScript">
function pasteCode475(code) {
    var myProject = external.Project;

    myProject.selectView('source');
    myProject.pasteCode('[=0x0022=]Timeless[=0x0022=][=0x000A=][=0x000A=]Examining something is acting fast. Looking is acting fast.[=0x000A=][=0x000A=][Now we need a rule which, just at the right moment, stops the turn sequence rulebook in the cast of our new fast-acting actions:][=0x000A=][=0x000A=]The take visual actions out of world rule is listed before the every turn stage rule in the turn sequence rules.[=0x000A=][=0x000A=]This is the take visual actions out of world rule: if acting fast, rule succeeds.[=0x000A=][=0x000A=][Thus the rest of the turn sequence rulebook is omitted for looking or examining: in effect, they become out-of-world actions like [=0x0022=]saving the game[=0x0022=]. If we wanted to add, say, taking inventory to the list of instant activities, we would just need to define it as acting fast, too.][=0x000A=][=0x000A=][Now the scenario for testing:][=0x000A=][=0x000A=]When play begins:[=0x000A=][=0x0009=]say [=0x0022=]You are cornered by a pack of zombie wolves, armed only with a torch and a pair of pinking shears. This may be your last moment on earth, unless you can think fast![=0x0022=][=0x000A=][=0x000A=]Cleft is a room. [=0x0022=]You[=0x0027=]re backed into a cleft in the granite: behind you are only steep, high faces of stone, and before you a narrow passage.[=0x0022=][=0x000A=][=0x000A=]The plural of zombie wolf is zombie wolves. A zombie wolf is a kind of animal. Four zombie wolves are in Cleft.[=0x000A=][=0x000A=]Rule for writing a paragraph about zombie wolves:[=0x000A=][=0x0009=]say [=0x0022=]The good news is that there isn[=0x0027=]t much space in which for the zombie wolves to attack.[=0x0022=];[=0x000A=][=0x0009=]now every zombie wolf is mentioned.[=0x000A=][=0x000A=]A steep high face of stone is scenery in Cleft. Understand [=0x0022=]rock[=0x0022=] as the stone. The description is [=0x0022=]Now that you look more closely, there appear to be pitons driven into the rock.[=0x0022=][=0x000A=][=0x000A=]Some pitons are part of the stone. The description of the pitons is [=0x0022=]It looks as though someone else has made this ascent before.[=0x0022=][=0x000A=][=0x000A=]Instead of climbing the stone, try going up. Instead of climbing the pitons, try going up.[=0x000A=][=0x000A=]Above the Cleft is Clifftop.[=0x000A=][=0x000A=]Every turn when the location is Cleft:[=0x000A=][=0x0009=]say [=0x0022=]Alas, your time has run out. The alpha wolf springs--[=0x0022=];[=0x000A=][=0x0009=]end the game in death.[=0x000A=][=0x000A=]Every turn when the location is Clifftop:[=0x000A=][=0x0009=]say [=0x0022=]After a breathless climb, you emerge at last onto the open clifftop.[=0x0022=];[=0x000A=][=0x0009=]end the game in victory.[=0x000A=][=0x000A=]Test me with [=0x0022=]x me / x stone / x pitons / climb pitons[=0x0022=].[=0x000A=][=0x000A=]');
}
</script>
<a href="javascript:pasteCode475()"><img border=0 src=../doc_images/paste.png></a> &quot;Timeless&quot;
</font></blockquote><p>
<p>
<blockquote><font color="#000080">Examining something is acting fast. Looking is acting fast.
</font></blockquote><p>
<p>
<p>Now we need a rule which, just at the right moment, stops the turn sequence rulebook in the cast of our new fast-acting actions:
<p>
<blockquote><font color="#000080">The take visual actions out of world rule is listed before the every turn stage rule in the turn sequence rules.
</font></blockquote><p>
<p>
<blockquote><font color="#000080">This is the take visual actions out of world rule: if acting fast, rule succeeds.
</font></blockquote><p>
<p>
<p>Thus the rest of the turn sequence rulebook is omitted for looking or examining: in effect, they become out-of-world actions like &quot;saving the game&quot;. If we wanted to add, say, taking inventory to the list of instant activities, we would just need to define it as acting fast, too.
<p>
<p>Now the scenario for testing:
<p>
<blockquote><font color="#000080">When play begins:
<br>&nbsp;&nbsp;&nbsp;&nbsp;say &quot;You are cornered by a pack of zombie wolves, armed only with a torch and a pair of pinking shears. This may be your last moment on earth, unless you can think fast!&quot;
</font></blockquote><p>
<p>
<blockquote><font color="#000080">Cleft is a room. &quot;You're backed into a cleft in the granite: behind you are only steep, high faces of stone, and before you a narrow passage.&quot;
</font></blockquote><p>
<p>
<blockquote><font color="#000080">The plural of zombie wolf is zombie wolves. A zombie wolf is a kind of animal. Four zombie wolves are in Cleft.
</font></blockquote><p>
<p>
<blockquote><font color="#000080">Rule for writing a paragraph about zombie wolves:
<br>&nbsp;&nbsp;&nbsp;&nbsp;say &quot;The good news is that there isn't much space in which for the zombie wolves to attack.&quot;;
<br>&nbsp;&nbsp;&nbsp;&nbsp;now every zombie wolf is mentioned.
</font></blockquote><p>
<p>
<blockquote><font color="#000080">A steep high face of stone is scenery in Cleft. Understand &quot;rock&quot; as the stone. The description is &quot;Now that you look more closely, there appear to be pitons driven into the rock.&quot;
</font></blockquote><p>
<p>
<blockquote><font color="#000080">Some pitons are part of the stone. The description of the pitons is &quot;It looks as though someone else has made this ascent before.&quot;
</font></blockquote><p>
<p>
<blockquote><font color="#000080">Instead of climbing the stone, try going up. Instead of climbing the pitons, try going up.
</font></blockquote><p>
<p>
<blockquote><font color="#000080">Above the Cleft is Clifftop.
</font></blockquote><p>
<p>
<blockquote><font color="#000080">Every turn when the location is Cleft:
<br>&nbsp;&nbsp;&nbsp;&nbsp;say &quot;Alas, your time has run out. The alpha wolf springs--&quot;;
<br>&nbsp;&nbsp;&nbsp;&nbsp;end the game in death.
</font></blockquote><p>
<p>
<blockquote><font color="#000080">Every turn when the location is Clifftop:
<br>&nbsp;&nbsp;&nbsp;&nbsp;say &quot;After a breathless climb, you emerge at last onto the open clifftop.&quot;;
<br>&nbsp;&nbsp;&nbsp;&nbsp;end the game in victory.
</font></blockquote><p>
<p>
<blockquote><font color="#000080">Test me with &quot;x me / x stone / x pitons / climb pitons&quot;.
</font></blockquote><p>
<p>
<p>Note that a procedural rule like this one must not be used:
<p>
<blockquote><font color="#000080">Procedural rule when acting fast: ignore the turn sequence rules.
</font></blockquote><p>
<p>
<p>If the turn sequence is ignored, no commands are read, no actions generated, and the game may hang. Besides, as noted elsewhere, while procedural rules are extremely powerful they can slow down the game when they are present in large numbers.
<table CELLPADDING=0 CELLSPACING=0 width="100%" height=18><tr><td width="100%"> </td><td width=18 align="left" bgcolor="#000000"><a href=doc325.html><img src=../doc_images/Hookclose.png id="hookclose" style="height: 17px; width: 17px;" border="0"></a></td><td width=4></td></tr></table></td></tr></table><p>
<!-- EXAMPLE END -->
<a name="e1"><table CELLPADDING=0 CELLSPACING=0 width="100%"><tr><td halign="left" valign="top" CELLPADDING=0 CELLSPACING=0 width=38px><TABLE align="left" CELLPADDING=0 CELLSPACING=0><TR CLASS="oval"><TD width=38px height=30px align="left" valign="center"><a href=ex1.html#e1 STYLE="text-decoration: none"><div class="paragraph Body" style="line-height: 1px; margin-bottom: 0px; margin-top: 4px; padding-bottom: 0pt; padding-top: 4px; text-align: center; color: #202020; font-size: 14px; line-height: 1px;"><b>376</b></div></a></TD></TR></TABLE></td><td CELLPADDING=0 CELLSPACING=0 halign="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><a href=ex1.html#e1 STYLE="text-decoration: none"><img border="0" style="height: 15px; width: 13px;" alt="*" src='../doc_images/asterisk.png'><img border="0" style="height: 15px; width: 13px;" alt="*" src='../doc_images/asterisk.png'><b><font color="#505050">&nbsp;Example&nbsp;</font> <font color="#000000"> Escape from the Seraglio</font></b></a><br>Replacing the usual response to TAKE ALL so that instead of output such as "grapes: Taken. orange: Taken.", Inform produces variable responses in place of "grapes:".<p></td><td halign="right" valign="top" CELLPADDING=0 CELLSPACING=0 width=38px><TABLE align="left" CELLPADDING=0 CELLSPACING=0><TR CLASS="rbarrow"><TD width=38px height=30px align="left" valign="center"><a  href=Rex1.html#e1 STYLE="text-decoration: none"><div class="paragraph Body" style="line-height: 1px; margin-bottom: 0px; margin-top: 4px; padding-bottom: 0pt; padding-top: 4px; text-align: center; color: #202020; font-size: 14px; line-height: 1px;"><i>RB</i></div></a></TD></TR></TABLE></td></tr></table>
<a name="e45"><table CELLPADDING=0 CELLSPACING=0 width="100%"><tr><td halign="left" valign="top" CELLPADDING=0 CELLSPACING=0 width=38px><TABLE align="left" CELLPADDING=0 CELLSPACING=0><TR CLASS="oval"><TD width=38px height=30px align="left" valign="center"><a href=ex45.html#e45 STYLE="text-decoration: none"><div class="paragraph Body" style="line-height: 1px; margin-bottom: 0px; margin-top: 4px; padding-bottom: 0pt; padding-top: 4px; text-align: center; color: #202020; font-size: 14px; line-height: 1px;"><b>377</b></div></a></TD></TR></TABLE></td><td CELLPADDING=0 CELLSPACING=0 halign="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><a href=ex45.html#e45 STYLE="text-decoration: none"><img border="0" style="height: 15px; width: 13px;" alt="*" src='../doc_images/asterisk.png'><img border="0" style="height: 15px; width: 13px;" alt="*" src='../doc_images/asterisk.png'><b><font color="#505050">&nbsp;Example&nbsp;</font> <font color="#000000"> Endurance</font></b></a><br>Giving different actions a range of durations using a time allotment rulebook.<p></td><td halign="right" valign="top" CELLPADDING=0 CELLSPACING=0 width=38px><TABLE align="left" CELLPADDING=0 CELLSPACING=0><TR CLASS="rbarrow"><TD width=38px height=30px align="left" valign="center"><a  href=Rex45.html#e45 STYLE="text-decoration: none"><div class="paragraph Body" style="line-height: 1px; margin-bottom: 0px; margin-top: 4px; padding-bottom: 0pt; padding-top: 4px; text-align: center; color: #202020; font-size: 14px; line-height: 1px;"><i>RB</i></div></a></TD></TR></TABLE></td></tr></table>
<p><hr><table CELLPADDING=0 CELLSPACING=0 width="100%"><tr><td width="33%" align="left"><a href=doc324.html border=0 STYLE="text-decoration: none"><font color="808080" size="2">Previous</font></a></td><td width="33%" align="center"><a href=../index.html border=0 STYLE="text-decoration: none"><font color="808080" size="2">Contents</font></a></td><td width="33%" align="right"><a href=doc326.html border=0 STYLE="text-decoration: none"><font color="808080" size="2">Next</font></a></td></tr></table></font></body></html>
